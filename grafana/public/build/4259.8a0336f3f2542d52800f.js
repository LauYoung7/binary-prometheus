"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[4259],{30173:(W,g,e)=>{e.d(g,{h:()=>t});var o=e(29427);const t=o.C.injectEndpoints({endpoints:a=>({getAlertmanagerChoiceStatus:a.query({query:()=>({url:"/api/v1/ngalert"}),providesTags:["AlertmanagerChoice"]}),getExternalAlertmanagerConfig:a.query({query:()=>({url:"/api/v1/ngalert/admin_config"}),providesTags:["AlertmanagerChoice"]}),getExternalAlertmanagers:a.query({query:()=>({url:"/api/v1/ngalert/alertmanagers"}),transformResponse:c=>c.data}),saveExternalAlertmanagersConfig:a.mutation({query:c=>({url:"/api/v1/ngalert/admin_config",method:"POST",data:c}),invalidatesTags:["AlertmanagerChoice"]})})})},40106:(W,g,e)=>{e.d(g,{C0:()=>f,Uv:()=>c,Xq:()=>d});var o=e(68404),t=e(45253),a=e(19985),c=(m=>(m.ContactPoint="contact point",m.Template="template",m.MuteTiming="mute timing",m.AlertRule="alert rule",m.RootNotificationPolicy="root notification policy",m))(c||{});const d=({resource:m})=>o.createElement(t.b,{title:`This ${m} cannot be edited through the UI`,severity:"info"},"This ",m," has been provisioned, that means it was created by config. Please contact your server admin to update this ",m,"."),f=()=>o.createElement(a.C,{text:"Provisioned",color:"purple"})},30151:(W,g,e)=>{e.d(g,{F:()=>O});var o=e(52423),t=e(82897),a=e.n(t),c=e(68404),d=e(26418),f=e(54408),m=e(72648),r=e(39904),v=e(64353),p=e(61860),P=e(46967),y=e(41904);const O=({className:T,onFilterChange:D,defaultQueryString:n})=>{const l=(0,m.wW)(I),i=(0,c.useMemo)(()=>(0,t.debounce)(C=>{(0,f.PN)(y.z7.filterByLabel);const R=C.target;D(R.value)},600),[D]);(0,c.useEffect)(()=>i.cancel(),[i]);const u=c.createElement(r.J,{name:"search"});return c.createElement("div",{className:T},c.createElement(v._,null,c.createElement(d.Stack,{gap:.5},c.createElement("span",null,"Search by label"),c.createElement(p.u,{content:c.createElement("div",null,"Filter alerts using label querying, ex:",c.createElement("pre",null,'{severity="critical", instance=~"cluster-us-.+"}'))},c.createElement(r.J,{className:l.icon,name:"info-circle",size:"sm"})))),c.createElement(P.I,{placeholder:"Search",defaultValue:n,onChange:i,"data-testid":"search-query-input",prefix:u,className:l.inputWidth}))},I=T=>({icon:o.css`
    margin-right: ${T.spacing(.5)};
  `,inputWidth:o.css`
    width: 340px;
    flex-grow: 0;
  `})},41273:(W,g,e)=>{e.d(g,{E:()=>v});var o=e(52423),t=e(68404),a=e(37932),c=e(72648),d=e(31403),f=e(98102),m=e(60048),r=e(93411);const v=t.forwardRef(({text:P,ruleIdentifier:y,isProvisioned:O,className:I},T)=>{const[D,n]=(0,t.useState)(void 0),l=(0,c.wW)(p),i=(0,r.u)("/alerting/new",{copyFrom:m.$V(y)});return t.createElement(t.Fragment,null,t.createElement(d.Qj,{title:"Copy",className:I,size:"sm",key:"clone",variant:"secondary",icon:"copy",href:O?void 0:i,onClick:O?()=>n(i):void 0,ref:T},P),t.createElement(f.s,{isOpen:!!D,title:"Copy provisioned alert rule",body:t.createElement("div",null,t.createElement("p",null,"The new rule will ",t.createElement("span",{className:l.bold},"NOT")," be marked as a provisioned rule."),t.createElement("p",null,"You will need to set a new alert group for the copied rule because the original one has been provisioned and cannot be used for rules created in the UI.")),confirmText:"Copy",onConfirm:()=>D&&a.E1.push(D),onDismiss:()=>n(void 0)}))});v.displayName="CloneRuleButton";const p=P=>({bold:o.css`
    font-weight: ${P.typography.fontWeightBold};
  `})},49279:(W,g,e)=>{e.d(g,{f:()=>Le});var o=e(52423),t=e(68404),a=e(70356),c=e(8928),d=e(27677),f=e(35645),m=e(72648),r=e(31403),v=e(94599),p=e(52081),P=e(98102),y=e(60499),O=e(82002),I=e(39031),T=e(81168),D=e(46063),n=e(30173),l=e(44391),i=e(35029),u=e(82897),C=e(38849),R=e(26418),x=e(61744),M=e(45253),U=e(24799),B=e(64353),A=e(61860),b=e(39904),S=e(46967),N=e(72004),$=e(69945);function se(s){const E=(0,T.useDispatch)(),h=(0,$._)(_=>_.managedAlertStateHistory);return(0,t.useEffect)(()=>{E((0,N.Ms)(s))},[E,s]),h}var w=e(24782),k=e(53731),L=e(45608);const le=({alertId:s})=>{const[E,h]=(0,t.useState)(""),_=(0,t.useCallback)(H=>{h(H.currentTarget.value)},[]),{loading:K,error:F,result:G=[]}=se(s),X=(0,m.wW)(Y);if(K&&!F)return t.createElement(x.u,{text:"Loading history..."});if(F&&!K)return t.createElement(M.b,{title:"Failed to fetch alert state history"},F.message);const ge=[{id:"state",label:"State",size:"max-content",renderCell:ce},{id:"value",label:"",size:"auto",renderCell:ie},{id:"timestamp",label:"Time",size:"max-content",renderCell:me}],ve=Object.entries(q(G)).sort().filter(([H])=>ee(H,E)).map(([H,oe])=>{const fe=oe.map(z=>({id:z.id,data:z}));return t.createElement("div",{key:H},t.createElement("header",{className:X.tableGroupKey},t.createElement("code",null,H)),t.createElement(k.t,{cols:ge,items:fe}))});return t.createElement("div",null,t.createElement("nav",null,t.createElement(U.g,{label:t.createElement(B._,null,t.createElement(R.Stack,{gap:.5},t.createElement("span",null,"Filter group"),t.createElement(A.u,{content:t.createElement("div",null,"Filter each state history group either by exact match or a regular expression, ex:"," ",t.createElement("code",null,"region=eu-west-1")," or ",t.createElement("code",null,"/region=us-.+/"))},t.createElement(b.J,{name:"info-circle",size:"sm"}))))},t.createElement(S.I,{prefix:t.createElement(b.J,{name:"search"}),onChange:_,placeholder:"Search"}))),ve)};function q(s){const E=s.map(h=>{const _=/{.*?}/g,K=h.text.match(_)?.at(-1)??"";return{id:String(h.id),state:h.newState,text:h.text.replace(K,""),data:h.data,timestamp:h.updated,stringifiedLabels:K}});return(0,u.groupBy)(E,h=>h.stringifiedLabels)}function ee(s,E){if(E==="")return!0;if(!(E.startsWith("/")&&E.endsWith("/")))return s.includes(E);try{return new RegExp(E.slice(1,-1)).test(s)}catch{return!1}}function ie(s){const E=s.data.data?.evalMatches??[];return t.createElement(t.Fragment,null,s.data.text,t.createElement(ue,null,E.map(h=>t.createElement(w.i,{key:h.metric,labelKey:h.metric,value:String(h.value)}))))}function ce(s){return t.createElement(L.l,{state:s.data.state})}function me(s){return t.createElement("div",{className:de},s.data.timestamp&&t.createElement("span",null,(0,C.dq)(s.data.timestamp)))}const ue=({children:s})=>{const{wrapper:E}=(0,m.wW)(Y);return t.createElement("div",{className:E},s)},de=o.css`
  display: flex;
  align-items: flex-end;
  flex-direction: column;
`,Y=s=>({wrapper:o.css`
    & > * {
      margin-right: ${s.spacing(1)};
    }
  `,tableGroupKey:o.css`
    margin-top: ${s.spacing(2)};
    margin-bottom: ${s.spacing(2)};
  `});function Oe(s){const[E,h]=(0,t.useState)(!1);return{StateHistoryModal:(0,t.useMemo)(()=>t.createElement(i.u,{isOpen:E,onDismiss:()=>h(!1),closeOnBackdropClick:!0,closeOnEscape:!0,title:"State history"},t.createElement(le,{alertId:s})),[s,E]),showStateHistoryModal:()=>h(!0),hideStateHistoryModal:()=>h(!1)}}var Ce=e(97953),Te=e(20194),te=e(37190),J=e(45849),ye=e(10505),Ee=e(60048),ne=e(79662),xe=e(58509),Re=e(2390);const Ve=({children:s,plugin:E,loadingComponent:h,notInstalledFallback:_})=>{const{loading:K,installed:F}=usePluginBridge(E);return K?h??null:F?React.createElement(React.Fragment,null,s):_??null};function Ae(s,E,h){const _=new URLSearchParams(h).toString();return`/a/${s}${E}`+(_?"?"+_:"")}const Ie=({title:s="",severity:E="",url:h=""})=>{const _=Ae(Re.W.Incident,"/incidents/declare",{title:s,severity:E,url:h}),{loading:K,installed:F,settings:G}=(0,xe.n)(Re.W.Incident);return t.createElement(t.Fragment,null,K===!0&&t.createElement(r.zx,{icon:"fire",size:"sm",type:"button",disabled:!0},"Declare Incident"),F===!1&&t.createElement(A.u,{content:"Grafana Incident is not installed or is not configured correctly"},t.createElement(r.zx,{icon:"fire",size:"sm",type:"button",disabled:!0},"Declare Incident")),G&&t.createElement(r.Qj,{icon:"fire",size:"sm",type:"button",href:_},"Declare Incident"))};var Ue=e(41273);const Le=({rule:s,rulesSource:E,isViewMode:h})=>{const _=(0,m.wW)(Be),{namespace:K,group:F,rulerRule:G}=s,X=(0,ne.Pc)(s.rulerRule)?s.rulerRule.grafana_alert.id??"":"",{StateHistoryModal:ge,showStateHistoryModal:ve}=Oe(X),H=(0,T.useDispatch)(),oe=(0,a.TH)(),fe=(0,y.iG)(),[z,pe]=(0,t.useState)(),Me=(0,J.HY)(E)?E:(0,Te.Xy)(E.jsonData.alertmanagerUid)?.name,We=O.Vt.hasPermission(T.AccessControlAction.DataSourcesExplore),j=[],Z=[],Se=()=>{if(z&&z.rulerRule){const V=Ee.Zk((0,J.EG)(z.namespace.rulesSource),z.namespace.name,z.group.name,z.rulerRule);H((0,N.hS)(V,{navigateTo:h?"/alerting/list":void 0})),pe(void 0)}},De=()=>{if((0,J.jq)(E)){const{appUrl:V,appSubUrl:Q}=f.v,ae=Q!==""?`${V}${Q}/`:f.v.appUrl,Ge=`${encodeURIComponent(E.name)}/${encodeURIComponent(s.name)}`;return`${ae}alerting/${Ge}/find`}return window.location.href.split("?")[0]},re=(0,ne.Jq)(F),Pe=(0,J.EG)(E),he=(0,ne.Pc)(s.rulerRule)&&Boolean(s.rulerRule.grafana_alert.provenance),be=(0,ne.x_)(s.promRule)&&s.promRule.state===D.x_.Firing,Ke=(0,Ce.Bz)(Pe),$e=O.Vt.hasPermission(Ke.create),{isEditable:Fe,isRemovable:Ne}=(0,l.M)(Pe,G),ze=_e(s),je=oe.pathname+oe.search;if((0,J.jq)(E)&&We&&!re&&j.push(t.createElement(r.Qj,{size:"sm",key:"explore",variant:"primary",icon:"chart-line",target:"__blank",href:(0,ye.mH)(E.name,s.query)},"See graph")),s.annotations[te.q6.runbookURL]&&j.push(t.createElement(r.Qj,{size:"sm",key:"runbook",variant:"primary",icon:"book",target:"__blank",href:c.QX.sanitizeUrl(s.annotations[te.q6.runbookURL])},"View runbook")),s.annotations[te.q6.dashboardUID]){const V=s.annotations[te.q6.dashboardUID];if(V){j.push(t.createElement(r.Qj,{size:"sm",key:"dashboard",variant:"primary",icon:"apps",target:"__blank",href:`d/${encodeURIComponent(V)}`},"Go to dashboard"));const Q=s.annotations[te.q6.panelID];Q&&j.push(t.createElement(r.Qj,{size:"sm",key:"panel",variant:"primary",icon:"apps",target:"__blank",href:`d/${encodeURIComponent(V)}?viewPanel=${encodeURIComponent(Q)}`},"Go to panel"))}}if(ze&&Me&&j.push(t.createElement(r.Qj,{size:"sm",key:"silence",icon:"bell-slash",target:"__blank",href:(0,ye.Vv)(Me,s)},"Silence")),X&&j.push(t.createElement(t.Fragment,{key:"history"},t.createElement(r.zx,{size:"sm",icon:"history",onClick:()=>ve()},"Show state history"),ge)),be&&j.push(t.createElement(t.Fragment,{key:"declare-incident"},t.createElement(Ie,{title:s.name,url:De()}))),h&&G){const V=(0,J.EG)(E),Q=Ee.Zk(V,K.name,F.name,G);if(Fe&&!re&&(Z.push(t.createElement(v.m,{key:"copy",icon:"copy",onClipboardError:ae=>{fe.error("Error while copying URL",ae)},size:"sm",getText:De},"Copy link to rule")),!he)){const ae=d.Cj.renderUrl(`${f.v.appSubUrl}/alerting/${encodeURIComponent(Ee.$V(Q))}/edit`,{returnTo:je});Z.push(t.createElement(r.Qj,{size:"sm",key:"edit",variant:"secondary",icon:"pen",href:ae},"Edit"))}$e&&!re&&Z.push(t.createElement(Ue.E,{key:"clone",text:"Copy",ruleIdentifier:Q,isProvisioned:he})),Ne&&!re&&!he&&Z.push(t.createElement(r.zx,{size:"sm",type:"button",key:"delete",variant:"secondary",icon:"trash-alt",onClick:()=>pe(s)},"Delete"))}return j.length||Z.length?t.createElement(t.Fragment,null,t.createElement("div",{className:_.wrapper},t.createElement(p.Lh,{width:"auto"},j.length?j:t.createElement("div",null)),t.createElement(p.Lh,{width:"auto"},Z.length?Z:t.createElement("div",null))),!!z&&t.createElement(P.s,{isOpen:!0,title:"Delete rule",body:"Deleting this rule will permanently remove it from your alert rule list. Are you sure you want to delete this rule?",confirmText:"Yes, delete",icon:"exclamation-triangle",onConfirm:Se,onDismiss:()=>pe(void 0)})):null};function _e(s){const E=(0,ne.Pc)(s.rulerRule),{useGetAlertmanagerChoiceStatusQuery:h}=n.h,{currentData:_,isLoading:K}=h(void 0,{skip:!E});if(!E||K)return!1;const F=O.Vt.hasAccess(T.AccessControlAction.AlertingInstanceCreate,O.Vt.isEditor),G=_?.alertmanagersChoice===I.TE.External,X=_?.alertmanagersChoice===I.TE.All;return F&&(!G||X)}const Be=s=>({wrapper:o.css`
    padding: ${s.spacing(2)} 0;
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    flex-wrap: wrap;
    border-bottom: solid 1px ${s.colors.border.medium};
  `})},68854:(W,g,e)=>{e.d(g,{J:()=>d});var o=e(52423),t=e(68404),a=e(72648),c=e(78543);function d(m){const{annotations:r}=m,v=(0,a.wW)(f);return r.length===0?null:t.createElement("div",{className:v.annotations},r.map(([p,P])=>t.createElement(c.a,{key:p,annotationKey:p,value:P})))}const f=()=>({annotations:o.css`
    margin-top: 46px;
  `})},24990:(W,g,e)=>{e.d(g,{C:()=>v});var o=e(52423),t=e(68404),a=e(86647),c=e(72648),d=e(47471),f=e(45849),m=e(79662),r=e(80498);function v(P){const{rulesSource:y,rule:O}=P,I=(0,c.wW)(p),T=(0,t.useMemo)(()=>{if((0,f.jq)(y))return[{name:y.name,icon:y.meta.info.logos.small}];if((0,m.Pc)(O.rulerRule)){const{data:D}=O.rulerRule.grafana_alert,n=D.reduce((l,i)=>{const u=(0,a.F)().getInstanceSettings(i.datasourceUid);return!u||u.uid===d.Yq||(l[u.name]={name:u.name,icon:u.meta.info.logos.small}),l},{});return Object.values(n)}return[]},[O,y]);return T.length===0?null:t.createElement(r.C,{label:"Data source"},T.map(({name:D,icon:n},l)=>t.createElement("div",{key:D},n&&t.createElement(t.Fragment,null,t.createElement("img",{alt:`${D} datasource logo`,className:I.dataSourceIcon,src:n})," "),D)))}function p(P){const y=P.spacing(2);return{dataSourceIcon:o.css`
      width: ${y};
      height: ${y};
    `}}},8674:(W,g,e)=>{e.d(g,{C:()=>D});var o=e(52423),t=e(68404),a=e(45849),c=e(80498),d=e(57706),f=e(56747),m=e(67660),r=e(12724),v=e(72648),p=e(19370),P=e(21899),y=e(94884);const O=({language:l,expr:i})=>{const u=(0,t.useMemo)(()=>[(0,m.Z)({onlyIn:R=>R.type==="code_block",getSyntax:()=>l},{...d.languages,[l]:l==="logql"?p.ZP:P.ZP})],[l]),C=(0,t.useMemo)(()=>(0,r.l1)(i),[i]);return t.createElement(f.ML,{"data-testid":"expression-editor",plugins:u,value:C})},I=({expression:l,rulesSource:i})=>{const u=(0,v.wW)(T);return t.createElement(y.t,{className:(0,o.cx)(u.well,"slate-query-field")},(0,a.jq)(i)?t.createElement(O,{expr:l,language:i.type===a.ye.Loki?"logql":"promql"}):l)},T=l=>({well:o.css`
    font-family: ${l.typography.fontFamilyMonospace};
  `});function D(l){const{annotations:i,rulesSource:u,rule:C}=l,R=n();return(0,a.jq)(u)?t.createElement(c.C,{label:"Expression",horizontal:!0,className:(0,o.cx)({[R.exprRow]:!!i.length})},t.createElement(I,{expression:C.query,rulesSource:u})):null}const n=()=>({exprRow:o.css`
    margin-bottom: 46px;
  `})},78443:(W,g,e)=>{e.d(g,{M:()=>C});var o=e(52423),t=e(82897),a=e(68404),c=e(72648),d=e(31403),f=e(30151),m=e(34719),r=e(64353),v=e(2594),p=e(46063);const P=({className:M,onStateFilterChange:U,stateFilter:B,filterType:A,itemPerStateStats:b})=>{const S=(0,c.wW)(y),N=L=>function(){return b&&b[L]?a.createElement(m.V,{name:b[L].toFixed(0),colorIndex:9,className:S.tag}):null},$=Object.values(p.bj).map(L=>({label:L,value:L,component:N(L)})),w=[p.x_.Firing,p.x_.Pending].map(L=>({label:(0,t.capitalize)(L),value:L,component:N(L)})),k=A==="grafana"?$:w;return a.createElement("div",{className:M,"data-testid":"alert-instance-state-filter"},a.createElement(r._,null,"State"),a.createElement(v.S,{options:k,value:B,onChange:U,onClick:L=>{L===B&&U(void 0)}}))};function y(M){return{tag:o.css`
      font-size: 11px;
      font-weight: normal;
      padding: ${M.spacing(.25,.5)};
      vertical-align: middle;
      margin-left: ${M.spacing(.5)};
    `}}var O=e(20194),I=e(10505),T=e(40286),D=e(45849),n=e(79662),l=e(80498),i=e(48563);function u(M){const U=(0,c.wW)(x),{ruleViewPageLink:B,stats:A}=M;return a.createElement("div",{className:U.footerRow},a.createElement("div",null,"Showing ",A.visibleItemsCount," out of ",A.totalItemsCount," instances"),B&&a.createElement(d.Qj,{href:B,size:"sm",variant:"secondary"},"Show all ",A.totalItemsCount," alert instances"))}function C(M){const{rule:{promRule:U,namespace:B},itemsDisplayLimit:A=Number.POSITIVE_INFINITY,pagination:b}=M,[S,N]=(0,a.useState)(),[$,se]=(0,a.useState)(),[w]=(0,a.useState)(Math.floor(Math.random()*100)),k=`queryString-${w}`,L=(0,c.wW)(x),le=(0,D.HY)(B.rulesSource)?D.GC:"prometheus",q=(0,a.useMemo)(()=>(0,n.x_)(U)&&U.alerts?.length?R(S,$,(0,I.Zl)(T.As.Importance,U.alerts)):[],[U,$,S]);if(!(0,n.x_)(U))return null;const ee=q.slice(0,A),ie=(0,t.countBy)(U.alerts,Y=>(0,p.ED)(Y.state)),ce=q.length-ee.length,me={totalItemsCount:q.length,visibleItemsCount:ee.length},ue=(0,I.V2)(B.rulesSource,M.rule,location.pathname+location.search),de=ce?a.createElement(u,{stats:me,ruleViewPageLink:ue}):void 0;return a.createElement(l.C,{label:"Matching instances",horizontal:!0},a.createElement("div",{className:(0,o.cx)(L.flexRow,L.spaceBetween)},a.createElement("div",{className:L.flexRow},a.createElement(f.F,{className:L.rowChild,key:k,defaultQueryString:S,onFilterChange:Y=>N(Y)}),a.createElement(P,{className:L.rowChild,filterType:le,stateFilter:$,onStateFilterChange:se,itemPerStateStats:ie}))),a.createElement(i.o,{instances:ee,pagination:b,footerRow:de}))}function R(M,U,B){let A=[...B];if(M){const b=(0,O.Zh)(M||"");A=A.filter(({labels:S})=>(0,O.eD)(S,b))}return U&&(A=A.filter(b=>(0,p.ED)(b.state)===U)),A}const x=M=>({flexRow:o.css`
      display: flex;
      flex-direction: row;
      align-items: flex-end;
      width: 100%;
      flex-wrap: wrap;
      margin-bottom: ${M.spacing(1)};
    `,spaceBetween:o.css`
      justify-content: space-between;
    `,rowChild:o.css`
      margin-right: ${M.spacing(1)};
    `,footerRow:o.css`
      display: flex;
      flex-direction: column;
      gap: ${M.spacing(1)};
      justify-content: space-between;
      align-items: center;
      width: 100%;
    `})},80399:(W,g,e)=>{e.d(g,{V:()=>f});var o=e(52423),t=e(68404),a=e(72648),c=e(61860),d=e(39904);const f=({rule:r})=>{const v=(0,a.wW)(m);return r.health==="err"||r.health==="error"?t.createElement(c.u,{theme:"error",content:r.lastError||"No error message provided."},t.createElement("div",{className:v.warn},t.createElement(d.J,{name:"exclamation-triangle"}),t.createElement("span",null,"error"))):t.createElement(t.Fragment,null,r.health)},m=r=>({warn:o.css`
    display: inline-flex;
    flex-direction: row;
    align-items: center;
    gap: ${r.spacing(1)};

    color: ${r.colors.warning.text};
  `})},48208:(W,g,e)=>{e.d(g,{p:()=>p});var o=e(52423),t=e(68404),a=e(37556),c=e(72648),d=e(52081),f=e(67487),m=e(46063),r=e(79662),v=e(45608);const p=({rule:y,isDeleting:O,isCreating:I,isPaused:T})=>{const D=(0,c.wW)(P),{promRule:n}=y,l=(0,t.useMemo)(()=>{if(n&&(0,r.x_)(n)&&n.alerts?.length&&n.state!==m.x_.Inactive){const i=(0,r.ub)(n);if(i)return t.createElement("span",{title:String(i),className:D.for},"for"," ",(0,a.vT)({start:i,end:new Date},!1))}return null},[n,D]);return O?t.createElement(d.Lh,{align:"flex-start"},t.createElement(f.$,null),"deleting"):I?t.createElement(d.Lh,{align:"flex-start"}," ",t.createElement(f.$,null),"creating"):n&&(0,r.x_)(n)?t.createElement(d.Lh,{align:"flex-start"},t.createElement(v.l,{state:n.state,isPaused:T}),l):n&&(0,r.OP)(n)?t.createElement(t.Fragment,null,"Recording rule"):t.createElement(t.Fragment,null,"n/a")},P=y=>({for:o.css`
    font-size: ${y.typography.bodySmall.fontSize};
    color: ${y.colors.text.secondary};
    white-space: nowrap;
    padding-top: 2px;
  `})},61627:(W,g,e)=>{e.d(g,{Kd:()=>r,Zo:()=>m});var o=e(82897),t=e.n(o),a=e(68404),c=e(45849),d=e(79662),f=e(69945);function m(n){const l=(0,f._)(R=>R.promRules),i=(0,f._)(R=>R.rulerRules),u=(0,a.useRef)({}),C=(0,a.useMemo)(()=>{if(n){const R=(0,c.o_)(n);if(!R)throw new Error(`Unknown rules source: ${n}`);return[R]}return(0,c.h_)()},[n]);return(0,a.useMemo)(()=>C.map(R=>{const x=(0,c.jq)(R)?R.name:R,M=l[x]?.result,U=i[x]?.result,B=u.current[x];if(B&&B.promRules===M&&B.rulerRules===U)return B.result;const A={};Object.entries(U||{}).forEach(([S,N])=>{const $={rulesSource:R,name:S,groups:[]};A[S]=$,p($,N)}),M?.forEach(({name:S,groups:N})=>{const $=A[S]=A[S]||{rulesSource:R,name:S,groups:[]};P($,N)});const b=Object.values(A);return u.current[x]={promRules:M,rulerRules:U,result:b},b}).flat(),[l,i,C])}function r(n){return n.map(l=>{const i={...l,groups:[]};return i.groups.push({name:"default",rules:v(l.groups.flatMap(u=>u.rules))}),i})}function v(n){return n.sort((l,i)=>l.name.localeCompare(i.name))}function p(n,l=[]){n.groups=l.map(i=>{const u={name:i.name,interval:i.interval,source_tenants:i.source_tenants,rules:[]};return u.rules=i.rules.map(C=>O(C,n,u)),u})}function P(n,l){const i=new Map;n.groups.forEach(u=>i.set(u.name,u)),l.forEach(u=>{let C=i.get(u.name);C||(C={name:u.name,rules:[]},n.groups.push(C),i.set(u.name,C));const R=new Map;C.rules.forEach(x=>{const M=R.get(x.name);M?M.push(x):R.set(x.name,[x])}),(u.rules??[]).forEach(x=>{const M=I(x,R,n.rulesSource);M?M.promRule=x:C.rules.push(y(x,n,C))})})}function y(n,l,i){return{name:n.name,query:n.query,labels:n.labels||{},annotations:(0,d.x_)(n)?n.annotations||{}:{},promRule:n,namespace:l,group:i}}function O(n,l,i){return(0,d.cG)(n)?{name:n.alert,query:n.expr,labels:n.labels||{},annotations:n.annotations||{},rulerRule:n,namespace:l,group:i}:(0,d.yF)(n)?{name:n.record,query:n.expr,labels:n.labels||{},annotations:{},rulerRule:n,namespace:l,group:i}:{name:n.grafana_alert.title,query:"",labels:n.labels||{},annotations:n.annotations||{},rulerRule:n,namespace:l,group:i}}function I(n,l,i){const u=l.get(n.name);if(!u)return;if((0,c.HY)(i))return u[0];const C=u.find(x=>!x.promRule&&T(x,n,!0));if(C)return C;const R=u.find(x=>!x.promRule&&T(x,n,!1));if(R)return R}function T(n,l,i=!0){return n.name===l.name?(0,o.isEqual)([i?D(n.query):"",n.labels,n.annotations],[i?D(l.query):"",l.labels||{},(0,d.x_)(l)?l.annotations||{}:{}]):!1}function D(n){return n.length>1&&n[0]==="("&&n[n.length-1]===")"&&(n=n.slice(1,-1)),n=n.replace(/\s|\n/g,""),n.split("").sort().join("")}},55485:(W,g,e)=>{e.d(g,{W:()=>f});var o=e(68404),t=e(81168),a=e(72004),c=e(46818),d=e(69945);function f(m){const r=(0,t.useDispatch)(),v=(0,d._)(p=>p.folders);if((0,o.useEffect)(()=>{m&&r((0,a.sw)(m))},[r,m]),m){const p=v[m]||c.oq;return{folder:p.result,loading:p.loading}}return{loading:!1}}},44391:(W,g,e)=>{e.d(g,{M:()=>f});var o=e(82002),t=e(97953),a=e(79662),c=e(55485),d=e(69945);function f(m,r){const v=(0,d._)(n=>n.dataSources),p=r&&(0,a.Pc)(r)?r.grafana_alert.namespace_uid:void 0,P=(0,t.Bz)(m),{folder:y,loading:O}=(0,c.W)(p);if(!r)return{isEditable:!1,isRemovable:!1,loading:!1};if((0,a.Pc)(r)){if(!p)throw new Error(`Rule ${r.grafana_alert.title} does not have a folder uid, cannot determine if it is editable.`);if(!y)return{isEditable:!1,isRemovable:!1,loading:O};const n=y.canSave,l=o.Vt.hasAccessInMetadata(P.update,y,n),i=o.Vt.hasAccessInMetadata(P.delete,y,n);return{isEditable:l,isRemovable:i,loading:O}}const I=Boolean(v[m]?.result?.rulerConfig),T=o.Vt.hasAccess(P.update,o.Vt.isEditor),D=o.Vt.hasAccess(P.delete,o.Vt.isEditor);return{isEditable:T&&I,isRemovable:D&&I,loading:v[m]?.loading}}},58509:(W,g,e)=>{e.d(g,{n:()=>a});var o=e(22350),t=e(13011);function a(c){const{loading:d,error:f,value:m}=(0,o.Z)(()=>(0,t.a)(c,{showErrorAlert:!1})),r=m&&!f&&!d,v=m?.enabled;return d&&!m?{loading:!0}:!r||!v?{loading:!1,installed:!1}:{loading:d,installed:!0,settings:m}}},2390:(W,g,e)=>{e.d(g,{W:()=>o});var o=(t=>(t.Incident="grafana-incident-app",t.OnCall="grafana-oncall-app",t.MachineLearning="grafana-ml-app",t))(o||{})},19370:(W,g,e)=>{e.d(g,{$5:()=>o,EH:()=>c,Rd:()=>a,ZP:()=>r,r8:()=>d,uR:()=>t,xY:()=>m});const o=[{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"}],t=[{label:"json",insertText:"json",documentation:"Extracting labels from the log line using json parser."},{label:"regexp",insertText:'regexp ""',documentation:"Extracting labels from the log line using regexp parser.",move:-1},{label:"logfmt",insertText:"logfmt",documentation:"Extracting labels from the log line using logfmt parser."},{label:"pattern",insertText:"pattern",documentation:"Extracting labels from the log line using pattern parser. Only available in Loki 2.3+."},{label:"unpack",insertText:"unpack",detail:"unpack identifier",documentation:'Parses a JSON log line, unpacking all embedded labels in the pack stage. A special property "_entry" will also be used to replace the original log line. Only available in Loki 2.2+.'}],a=[{label:"unwrap",insertText:"unwrap",detail:"unwrap identifier",documentation:"Take labels and use the values as sample data for metric aggregations."},{label:"label_format",insertText:"label_format",documentation:"Use to rename, modify or add labels. For example, | label_format foo=bar ."},{label:"line_format",insertText:"line_format",documentation:'Rewrites log line content. For example, | line_format "{{.query}} {{.duration}}" .'}],c=[{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average of all values in the specified interval."},{insertText:"bytes_over_time",label:"bytes_over_time",detail:"bytes_over_time(range-vector)",documentation:"Counts the amount of bytes used by each log stream for a given range"},{insertText:"bytes_rate",label:"bytes_rate",detail:"bytes_rate(range-vector)",documentation:"Calculates the number of bytes per second for each stream."},{insertText:"first_over_time",label:"first_over_time",detail:"first_over_time(range-vector)",documentation:"The first of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The last of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum of all values in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the number of entries per second."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."}],d=[...o,...c],f=[...d,...a,...t].map(v=>v.label),m={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((without|by)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-zA-Z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},"context-pipe":{pattern:/\s\|[^=~]\s?\w*/i,inside:{"pipe-operator":{pattern:/\|/i,alias:"operator"},"pipe-operations":{pattern:new RegExp(`${[...t,...a].map(v=>v.label).join("|")}`,"i"),alias:"keyword"}}},function:new RegExp(`\\b(?:${d.map(v=>v.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=\])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],quote:{pattern:/"(?:\\.|[^\\"])*"/,alias:"string",greedy:!0},backticks:{pattern:/`(?:\\.|[^\\`])*`/,alias:"string",greedy:!0},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:/\s?(\|[=~]?|!=?|<(?:=>?|<|>)?|>[>=]?)\s?/i,punctuation:/[{}(),.]/},r=m}}]);

//# sourceMappingURL=4259.8a0336f3f2542d52800f.js.map